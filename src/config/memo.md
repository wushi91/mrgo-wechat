
## 需求变更记录

### 给审核版本加入体验账号的功能

问题：纯手机号的登录方式不能满足微信测试需求。
解决方法：加入审核版本号。通过小程序内置审核版本号，在登陆页面的时候向后台查询当前正在审核的版本，如果返回的版本号跟小程序版本号相同，就显示体验账号的入口。
技术解决：向后台获取审核版本号，设置审核版本号。审核版本号的规则，A，B两种即可，安全保证，提供A，B，C，D四种审核版本号，交替使用。审核的版本跟线上版本不一样就可以了。
操作备忘：假设已经有线上小程序审核版本号为A，提交小程序审核，审核版本号为B，向后台设置审核版本为B，（线上版本A，正常体验，体验版小程序即B版登录会有体验账号入口），审核版本B通过之后，向后台设置审核版本为空，（线上版本A，正常体验，体验版和审核通过版本，正常体验），上线版本B，微信自动完成。没有操作风险。上线操作完成后，线上审核版本号为B。

查看线上审核版本号的方法
小程序，进入关于我们可以查看到版本号后缀如A即为审核版本号

如何设置版本号
/src/config/index.js


## 版本更新规则
版本更新检查，小程序的版本号，体验版，正式版，审核版本号是否符合规范。小程序访问的接口是否为线上地址
小版本变动需要记录具体修改的问题。
暂无

## 版本更新记录
### 2019/5/19
版本V1.0.0
审核过程中修改
通过添加体验账号的方式解决登录问题，
去除界面上无用的模块
### 2019/5/24
版本V1.0.1
1. 首页修改了图片，以及免费领取7天尊享会员
2. 空白商品，扫码后不会添加到购物车
3. 订单和购物车图片的调整
### 2019/6/15
提交审核时间:2019-06-15 14:45:00
版本:1.0.2.b
1. 扫描线下二维码（http://wechat.mrgo.club/buyVIP），领取7天免费会员。
2. 修复bug，微信扫一扫开门后，在用微信扫小程序会有开门
3. 取消代码分包的结构
4. 修复微信测试报告的优化建议：
（1）使用了 css 的 `:active` 伪类来实现点击态；
（2）存在可点击元素的响应区域过小；
（3）发现正在使用废弃接口createCanvasContext.setFillStyle、createCanvasContext.setFontSize
5. 开发者管理页面,可以开启和关闭体验账号
### 2019/7/8
提交审核时间：2019-07-08 13:53:00
版本：1.0.3.c
1. 修复的问题，由于门店二维码带有空格导致识别出错。
2. 修改了会员码的展示效果。
3. 新增功能，允许开发者修改访问的主机（测试服或者生产服），方便开发人员测试。

### 2019/7/15
版本：1.0.4.d
提交审核时间：2019-07-15 14:00:00
发布时间：2019-07-16 15:01:00
1. 根据微信小程序提示的bug集合， 'freshMemberInfo' of undefined，修复了调用的顺序。
2. 增加打开微信付款码的功能

### 2019/7/26
版本：1.0.5.a
提交审核时间：2019-07-26 14:01:00
发布时间：2019-07-26 16:13:00
1. 修复：订单列表数据出错的问题。第10个以后的订单，显示的数据跟第二个订单一样。解决方法：把点击事件调整到v-for层。具体原因，可能是mpvue框架的bug。（对比版本1.0.4和1.0.5，pages/orderList/index.vue）
2. 修复：订单列表空白图片的商品数量为多个，只显示一张图片的问题。
3. 修复：部分华为手机会员码生成失败的问题。使用延时刷新二维码，低概率生成失败。
4. 新增功能：扫描二维码http://wechat.mrgo.club/offlineStore，可进入会员码页面。
5. 修改首页的界面。点击轮播图第一张图可到会员码页面。
6. 优化了登录方式，登录失败重新更新loginCode。打log方便后期调试。


### 2019/8/3
版本：1.0.6.b
1. 修复7天后token失效需要重新授权登录的问题。用户只需要登录一次就可以了，后续能够自动刷新token。（需要更新线上服务器才能体验。）（测试和线上服务器切换会重新到登录页，因为会判断token还在有效期，会走其他的判断流程）
2. 会员码通过本地生成。字段为用户手机号和失效时间。通过RSA加密。（需要同时更新收银机和后台才能体验）
3. 优化会员码页面代码的层级结构。
4. 轮播图最多显示10张
5. 


### 2019/7/8


有可能的问题
修复：订单列表分页问题
微信头像获取不到的情况
会员码亮度调节，屏幕保持常亮，或者重新进入页面的时候刷新会员码
部分用户登录不了
部分用户无法扫码购(阿源)和扫码开门（娇姐）（有可能是组件调用的原因？）







